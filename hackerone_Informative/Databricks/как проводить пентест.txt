давай сфокусируемся на Databricks как на одной целевой программе и нормально «упакуем» векторы под их правила.

Сразу рамки (смотрю на policy через FireBounty):

Основной тестовый сайт:
dbc-a1ba5468-749b.staging.cloud.databricks.com + community.cloud.databricks.com – это главное мясо. 
Firebounty

Есть длинный список «extended assets» (www.databricks.com
, docs, help и т.д.), но там разрешён только пассивный / сетевой скан без «активных» действий (создание фейковых аккаунтов, изменение состояния сервисов и т.п.)
Firebounty

Приоритетные баги (доп. +25% к bounty на основном тестовом сайте):
Privilege Escalation, IDOR, Improper Access Control. 
Firebounty

Отдельный приз: $3000 гарантированно за выход из контейнера к соседним LXC/host OS. 
Firebounty

Плюс: Databricks официально пишет, что за 3 года принял почти 260 валидных bounty–репортов от ~150 ресёрчеров, так что программа реально живёт и платит. 
Databricks
+1

Ниже — векторы, которые прям ложатся под твой стиль (логика, доступы, токены), без фарма low-XSS.

1. Broken Access Control & PrivEsc внутри workspace (то, за что доплачивают)
Почему это важно именно у них

У Databricks сложная модель прав:

Workspace-объекты (ноутбуки, SQL-воркхаусы, джобы, файлы и т.д.) управляются через ACL (CAN READ / CAN RUN / CAN MANAGE). 
docs.databricks.com
+1

Account-уровень (service principals, группы, несколько workspaces) — отдельный RBAC. 
docs.databricks.com
+1

Данные (таблицы, views, модели) — через Unity Catalog. 
docs.databricks.com
+1

Т.е. миллион мест, где можно напортачить с правами.

Что конкретно пробовать

1.1. Горизонтальные IDOR/ACL баги по workspace-объектам

Цель: из обычного юзера увидеть/редактировать чужие:

ноутбуки, job’ы, dashboards;

workspace files;

init-скрипты, конфиги кластеров, secret scopes.

Как:

Логинишься на staging-workspace с выданными тест-аккаунтами (через их Google-форму). 
Firebounty

Включаешь DevTools → вкладка Network.

Делаешь через UI всё, что связано с доступами и объектами:

создание/шаринг ноутбука;

создание job/cluster;

изменение прав (Permissions, Share, Grant).

Ловишь REST-запросы вида /api/2.0/…/permissions, /api/2.0/…/notebooks, /jobs/, где в URL или body фигурируют object_id, notebookId, job_id, principalId и т.п.

Дальше классика:

Меняешь ID на чужой (который ты не должен видеть) — смотришь, вернётся ли содержимое/метаданные или 403.

Пытаешься ставить себе более высокий уровень прав (CAN_MANAGE, IS_ADMIN) на объекты, которые ты не создавал.

Проверяешь, не можешь ли дать права третьему аккаунту, хотя формально ты только обычный user.

Если хоть где-то получится:

читать чужой ноут/конфиг/secret scope,

запускать чужой job,

менять чужой ACL — это уже Improper Access Control / IDOR и попадает в их приоритетный список +25% к bounty. 
Firebounty

1.2. Вертикальный PrivEsc до workspace admin / account admin

Цель: из обычного пользователя стать:

workspace admin,

или получить доступ к account-уровневым фичам (user/group management, service principals и т.п.) 
docs.databricks.com
+1

Сценарии:

Формы/эндпоинты типа /workspace-conf, /permissions, /admin/users, где можно «случайно» самому себе выдать роль admin или включить себе entitlement.

Возможность импортировать/экспортировать конфиги (например, workspace settings в JSON), где твой user каким-то образом оказывается с расширенными правами после импорта.

2. IDOR по шэрингу, инвайтам и «мульти-тенант» сценариям

Databricks — классический multi-tenant: общий control plane, отдельные compute/data-planes по клиентам. 
docs.databricks.com
+2
Databricks
+2

Там много функций вида «поделиться чем-то»:

приглашение других в workspace;

sharing ноутбуков/файлов/дашбордов по ссылке;

возможно, публичные ссылочные share-ы (типа view link).

Что пробовать

Инвайты / join-flows.

Создаёшь workspace/группу/проектик, приглашаешь другой свой аккаунт.

Смотришь запросы с токенами инвайта (inviteId, token, email).

Пробуешь:

повторно использовать токен,

изменять email в запросе,

менять workspace_id / group_id → получить инвайт в чужой scope.

Shared links / публичные view-ссылки.
Если есть возможность «поделиться ссылкой»:

Проверяешь, не гуляет ли ID/тайтл объекта в query-параметрах без подписи.

Пробуешь менять ID на последовательные / чужие → читать чужие артефакты.

API-IDOR.
Вся их платформа крутится на REST-API. В доках есть список API для управления workspace, jobs, clusters и т.д. 
Databricks
+1

Берёшь эндпоинты управления объектами (jobs, clusters, secrets, repos) и проверяешь, что сервер действительно проверяет не только существование ID, но и права.

Хороший знак: 200 или 403 меняются на 404 при подмене ID.

Если находишь любую форму меж-аккаунтного или меж-workspace считывания/изменения — это именно то, что они хотят видеть как IDOR/Improper Access Control.

3. Секреты и токены: из workspace/кластера → control plane / сторонние сервисы

Очень в твой стиль.

Почему это ценно у Databricks

В блоге про init-скрипты они честно описали баг, когда low-priv юзер мог через init-скрипт получить root на кластере, вытянуть secrets и снять API-токен админа из control-plane трафика, а потом дергать REST-API от имени админа. 
Databricks

В более свежем посте они рассказывают, как исследователь нашёл credentials в Docker-образе, с помощью которых получил доступ к их GitHub/Okta, и за это они тоже заплатили. 
Databricks

=> Они реально платят за leaks с реальным импактом, особенно если ты доходишь до доступа к более привилегированным сервисам.

Где искать сейчас (без повторения старого бага)

DBFS / Workspace Files / Logs.
После фикса они перевели init-скрипты в workspace files с ACL и убрали deprecated варианты, но паттерн остаётся: в shared-storage могут валяться:

конфиги с токенами,

старые init-скрипты,

временные файлы с секретами. 
Databricks
+1

Идея:

изучить, что именно видит обычный юзер в DBFS / workspace files;

попытаться найти директории/файлы, где лежат не его артефакты (особенно что-то похожее на конфиги, .json, .conf, .yaml, .csv с кредами).

Если где-то «торчат» чувствительные данные (API keys, OAuth tokens, креды к внешним ресурсам) — это уже report.

Secrets at runtime.
Они сами пишут, что:

секреты выдаются кластерам при инициализации;

секреты могут появляться в конфиг-файлах типа /tmp/custom-spark.conf или в env-переменных процессов. 
Databricks

Если тебе, как low-priv юзеру, удаётся:

вытащить секреты, предназначенные для других пользователей/сервисов/tenant’ов,

или использовать их для вызова API от имени более привилегированной роли,

— это уже серьёзный impact. Важно: не лезть за реальными данными клиентов, использовать тестовые аккаунты и минимальный объём.

Leak в Docker образах / публичных артефактах.

Из блога по GitHub-инциденту:

исследователь скачал публичный Docker-образ, нашёл внутри креды и использовал их для доступа к GitHub/Okta; Databricks признали репорт и усилили защиту. 
Databricks

Потенциально:

просмотреть официальные Databricks-образы на Docker Hub / другие публичные реестры;

поискать hardcoded креды, токены, приватные URLs.

Важно: всегда остаёмся в рамках responsible disclosure (не пушить коммиты, не ломать CI/CD, только аккуратное подтверждение доступа).

4. Контейнер / LXC escape (hard-режим, но жирный bounty)

В policy прямо написано, что $3000 гарантированно за exploit, который:

позволяет выйти из текущего cluster-контейнера (LXC) и выполнить привилегированные команды в соседних LXC или хостовой ОС. 
Firebounty

При этом они отдельно подчёркивают:

Databricks — RCE-environment по дефолту, RCE в рамках одного кластера = нормальное поведение, а не баг. 
Firebounty

То есть интерес только в:

уязвимостях ядра/контейнеризации;

misconfig LXC, cgroups, namespace-изоляции;

возможности выйти из контейнера, пробраться в соседние, достать данные/секреты или управлять host-level.

Если захочешь туда залезать — это уже уровень kernel / container-escape ресёрча. Но прикольно, что триггер и награда чётко сформулированы.

5. Веб-логика + XSS, но с реальным импактом

Большой список web-доменов в scope (docs, support, academy, training, community, www.databricks.com
 и т.д.) 
Firebounty
. На extended assets:

разрешён network / passive scanning (DNS/web-сканы) 
Firebounty

запрещены активные действия, которые меняют состояние (создание аккаунтов, заявки и т.п.).

Реально ценно:

XSS/CSRF в control plane UI на основном тестовом сайте (dbc-…staging.cloud.databricks.com, community.cloud.databricks.com), которые позволяют:

украсть токен/сессию workspace admin,

«тихо» добавить тебя в админы/ACL какого-нибудь объекта,

дернуть чувствительный action (создать PAT, поменять настройки workspace и т.п.).

Простые alert(1) без chain’а → максимум informative. Но XSS + auto-PrivEsc/IDOR → отличный кандидат в high.

6. Как это собрать в твой рабочий план

Предлагаю такой скелет:

Завести тест-доступ.

Через их форму Databricks Credentials получить логин/пароль к main test site. 
Firebounty

Если разрешают — запросить второй аккаунт или использовать community-edition, чтобы смоделировать «жертву».

Сделать «карту объектов» workspace’а.

Какие типы объектов есть (notebooks, jobs, clusters, files, repos, secrets, dashboards).

Какие экраны/формы управляют правами.

Неделя чисто на Access Control / IDOR.

Снятие/анализ всех permission- и sharing-запросов.

Пошаговая проверка: горизонтальный доступ → вертикальный PrivEsc.

Следующая итерация — секреты и токены.

Проверка DBFS / workspace files / logs на утечки.

Проверка того, что low-priv user не может читать секреты/токены, не предназначенные ему.

Если останутся силы — смотреть на контейнеризацию.

Определить, какой именно контейнер runtime используется (LXC, kernel-версии).

Посмотреть на известные LXC/namespace-баги и аккуратно проверить, не уязвим ли их стэк (без DoS).
