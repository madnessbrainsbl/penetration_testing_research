Отчёт по анализу безопасности zooplus.de (Bug Bounty)

О программе и области охвата: Zooplus запустил публичную программу Bug Bounty на платформе HackerOne в марте 2025 года и уже выплатил исследователям суммарно свыше $500 000 вознаграждений (около 349 уязвимостей было исправлено на конец 2025)
hackerone.pathfactory.com
. В программу входят четыре основных домена: интернет-магазины на www.zooplus.de, www.zooplus.co.uk, www.zooplus.com и служебный домен zooplus.net
bbradar.io
bbradar.io
. Вне области – все прочие локальные сайты (напр. zooplus.at, .fr, .it и др.), аффилированные проекты (bitiba.de, zoohit.* и пр.), а также специальные разделы вроде ветеринарных порталов (напр. .../tierarzt)
bbradar.io
bbradar.io
. Политика программы исключает низкоопасные проблемы: например, open redirect (открытые перенаправления) принимаются только при наличии дополнительного влияния, а простые Self-XSS не рассматриваются, если их нельзя объединить в цепочку атаки
hackerone.com
.

Ранее выявленные уязвимости

Публичные отчёты и координированные раскрытия показывают, что у Zooplus уже находили ряд классических уязвимостей. Так, в 2015 и 2017 годах исследователи через OpenBugBounty сообщали о Cross-Site Scripting (XSS) на основном сайте zooplus.de, и эти проблемы были подтверждены и устранены
openbugbounty.org
. Кроме того, участники программы HackerOne отмечали нахождение IDOR-уязвимостей (несанкционированный прямой доступ к объектам) и даже Stored XSS на платформе Zooplus – эти типы багов фигурировали в их списке успешных находок
linkedin.com
. Сообщалось также об Open Redirect-уязвимостях (перенаправление на сторонние URL), слабых настройках защиты (например, отсутствующие заголовки типа X-Frame-Options, небезопасные cookies, слишком открытые CORS) и недостаточной защите от перебора (отсутствие rate limiting)
linkedin.com
. Некоторые из таких проблем были впоследствии раскрыты публично через Hacktivity HackerOne – например, как минимум одна уязвимость Zooplus была опубликована с вознаграждением $1000, что подразумевает уязвимость средней тяжести (возможно, утечка данных через IDOR или существенный XSS). В совокупности, эти прецеденты дают понимание, на какие классы проблем стоит обратить внимание в первую очередь.

Аутентификация и восстановление пароля

Механизмы регистрации, входа и сброса пароля – критичная область для поиска уязвимостей. Необходимо проверить защиту от брутфорса и массовых попыток входа: есть ли ограничение числа попыток логина или CAPTCHA (отсутствие rate-limit может позволить перебор паролей или массовую проверку учетных записей)
linkedin.com
. Важен анализ функционала восстановления пароля – насколько надёжно генерируются и проверяются токены сброса. Следует убедиться, что токен уникален, достаточно длинный и одноразовый. Также стоит проверить, не уязвим ли процесс восстановления к ** атакам типа CSRF** (подделка запроса на сброс пароля от имени пользователя) и нет ли возможности утечки токена через рефереры или перенаправления.

При регистрации полезно оценить, есть ли уязвимость на утечку информации о существовании аккаунта (например, различия в сообщениях об ошибке “пользователь не найден” vs “неверный пароль” позволяют перебирать email). Хотя это и минорный баг, некоторые программы его принимают. Кроме того, стоит убедиться, что активационные ссылки (если используются) имеют защиту от повторного использования и достаточно сложны.

Cookies и сессии: После входа генерируется сессионный cookie – нужно проверить его свойства. Безопасный cookie должен иметь флаги HttpOnly и Secure (для предотвращения кражи через XSS и передачи по HTTP). Также желательно наличие атрибута SameSite для защиты от CSRF. Стоит проверить, установлены ли эти флаги корректно (особенно на домене .de и .com). Если cookies устанавливаются на родительский домен и общие между субдоменами, это может быть вектором атак (например, фиксация сессии или перехват cookie на менее защищённом субдомене). Проверка на протокол HTTP: сайт, вероятно, перенаправляет на HTTPS, но если какие-то страницы доступны по HTTP без перенаправления, это серьёзная проблема (перехват сессии).

Корзина и оформление заказа

Функциональность корзины и процесса checkout – важная часть, где могут скрываться логические уязвимости. Следует проверить, нет ли возможностей манипуляции с ценами или товарами через подмену параметров. Например, на этапе оформления заказа можно попробовать изменить идентификаторы товара, количество, цену или применённые скидки в запросах (в идеале сервер игнорирует такие изменения, но ошибки в логике могут приводить к неверной итоговой сумме). Хотя чисто бизнес-логические баги (например, получить товар бесплатно) зачастую считаются out-of-scope, сами попытки могут выявить уязвимости валидности данных на стороне сервера.

Проверка на CSRF: Добавление товара в корзину, изменение адреса доставки, выбор способа оплаты – все эти действия должны требовать валидного пользовательского запроса. Если сайт не использует токены против CSRF, злоумышленник мог бы сформировать ссылку или форму, невидимо для пользователя добавляющую товар в его корзину или меняющую данные заказа. Особенно критично, если оформление заказа (например, последний шаг подтверждения) не защищено от CSRF – тогда атакующий мог бы вынудить жертву случайно что-то заказать (при условии сохранённых данных оплаты). Необходимо проверить наличие CSRF-токенов или других механизмов (Origin-референсы) на ключевых шагах.

IDOR в данных заказа: Нужно обратить внимание, как реализован просмотр и подтверждение заказа. Каждый заказ, как правило, имеет уникальный ID; важно убедиться, что пользователь не может запрашивать чужой заказ по перебору ID. Например, если имеется страница или API: /order/view?orderId=XYZ, то перебор orderId вне своего диапазона должен быть запрещён. Стоит протестировать, можно ли, будучи авторизованным, открыть заказ другого пользователя (или скачать чужой счёт-фактуру, если URL предсказуемый). Файлы счетов/чеков: если PDF счета доступны по URL вида .../invoice/ORDER12345.pdf без достаточной авторизации, это потенциальная утечка данных (IDOR).

Промокоды и акции

Модуль промокодов, купонов и акций тоже заслуживает изучения, хотя напрямую злоупотребление купонами обычно вне области программы (т.е. получение финансовой выгоды от ошибки бизнеса, а не технической уязвимости, обычно не вознаграждается). Тем не менее, исследование этой части может выявить сопутствующие проблемы. Например, можно проверить браузерные запросы при применении промокода – нет ли возможности инъекции (XSS) через поле ввода кода, или раскрытия внутренней информации (например, ответ сервера содержит скрытые детали о логике скидок). Интересен и вопрос enumeration: позволяют ли механизмы сайта массово перебирать коды купонов (отсутствие rate-limit тут тоже актуально)? Если нет ограничения, злоумышленник мог бы подобрать некоторые действующие промокоды перебором, но чаще всего такие атаки затруднены из-за длинных случайных кодов.

Также стоит узнать, нет ли логических уязвимостей: к примеру, можно ли применить истёкший купон, просто изменив дату на клиенте, или использовать купон многократно, манипулируя запросами. Подобные сценарии обычно считаются нарушением бизнес-правил, но если их удастся осуществить чисто через уязвимость (например, отсутствие серверной проверки), это может быть принято как баг. В любом случае, при работе с промо-механизмами важно не выходить за рамки разрешённого (не совершать реальные мошеннические заказы), но наблюдать за ответами API. Если промо-API существует, его стоит проверить на отсутствие авторизации – например, можно ли узнать детали акции, предназначенной для другого сегмента пользователей, просто изменив параметр.

(Примечание: Zooplus может объявлять все вариации злоупотребления промокодами out-of-scope, поэтому основные интересные находки тут – XSS через купонный ввод, утечки информации об акциях или DoS-эффекты, если, например, неограниченно большой список купонов можно ввести.)

Личный кабинет и данные пользователя

В профиле пользователя (личном кабинете) сосредоточены функции управления данными – история заказов, сохранённые адреса, платёжные методы, настройки и т.д. Здесь главный кандидат на проверку – уязвимости типа IDOR (нарушение контроля доступа к объектам). Необходимо проверить, может ли один аутентифицированный пользователь получить доступ к чужим данным, просто поменяв какой-либо идентификатор. Например:

История заказов: Если URL или запрос для просмотра деталей заказа содержит orderId, убедиться, что нельзя просмотреть чужой заказ подставив другой ID (как упоминалось ранее).

Адресная книга: Проверить функции добавления/редактирования/удаления адресов. Часто у адресов бывают числовые ID; убедиться, что отправив запрос с чужим addressId нельзя увидеть или изменить адрес другого пользователя. Подобный IDOR был бы критичным, так как раскрывает персональные данные (имя, адрес) и позволяет их менять.

Профиль и данные пользователя: Если есть отдельный API или страница профиля /user?id=123, убедиться, что игнорируется изменение ID на чужой – пользователь должен видеть только свои данные.

Cross-Site Scripting: Личный кабинет предоставляет поля ввода, которые могут отобразиться где-то ещё. Нужно проверить поля имени, адреса, комментариев к заказу, аватара (если есть) на предмет XSS. Например, если в имя пользователя вписать строку вроде <script>alert(1)</script>, отобразится ли она где-либо несантитизированной? Stored XSS может возникнуть, если эти данные затем показываются (администратору в CRM или самому пользователю в HTML-контексте) без экранирования. Хотя самостоятельно исполнить свой же скрипт (Self-XSS) не даёт привилегий, Stored XSS в чужом контексте – серьёзная находка. Возможный сценарий: вставить вредоносный код в поле адреса, оформить заказ и дождаться, пока оператор поддержки откроет детали заказа – если админ-панель уязвима к такому входящему коду, можно выполнить XSS уже в браузере сотрудника (это требует знания внутренней панели, но проверка наличия базового HTML-экранирования в email-уведомлениях или PDF счета – полезна).

CSRF на действия в кабинете: Убедиться, что изменение критичных настроек требует подтверждения. Например, смена email или пароля обычно должна требовать ввода текущего пароля или дополнительной аутентификации – проверить, так ли это. Если сменить email можно без ввода пароля и без подтверждения по ссылке, злоумышленник, украв сессию, мог бы привязать аккаунт к своему email (это уже логическая проблема безопасности аккаунта). Но даже без компрометации сессии, CSRF-атака могла бы сменить адрес доставки или подписать пользователя на рассылку, если нет защиты. Поэтому важные POST-запросы (обновление профиля, добавление платежных карт, и т.п.) должны содержать CSRF-токен – стоит убедиться в его наличии.

Публичные API и мобильное приложение

Если у Zooplus есть мобильное приложение или публичные API (например, для партнёров или интеграции), их нужно включить в исследование. Нередко мобильное приложение обращается к REST или GraphQL API на домене вроде api.zooplus.net или поддоменах m.zooplus.de. Следует попытаться обнаружить такие вызовы (например, проанализировав сетевой трафик приложения или поискать известные endpoints). API-вызовы могут быть уязвимы к тем же проблемам: отсутствие проверок авторизации (IDOR), утечки данных в ответах, массовый перебор. Преимущество API – часто более явная структура запросов, что упрощает тестирование.

Например, если существует эндпоинт GET /api/orders/{orderId}, нужно проверить, ограничен ли он только своими заказами. Если API не проверяет текущего пользователя, это прямой IDOR и критичный баг. Аналогично, API для обновления данных (PUT/POST запросы) должны требовать авторизацию и действовать в пределах разрешённого.

Также стоит проверить настройки CORS: если API предназначен только для first-party, то он не должен отвечать на запросы с произвольных Origins. Lax CORS (например, когда Access-Control-Allow-Origin: * на приватные данные) – серьёзная ошибка, позволяющая в ряде случаев красть данные через XSS на любом сайте
linkedin.com
.

Rate limiting в API: Если APIEndpoints позволяют, например, проверять статус заказа по номеру, убедитесь, что есть ограничения на количество запросов в единицу времени. Без rate-limit злоумышленник может перебрать множество ID и собрать статистику (даже если данные частично скрыты).

Наконец, GraphQL (если используется) требует проверки схемы – иногда introspection открыта и можно вытащить всю схему, что само по себе не баг, но упрощает поиск. Также GraphQL часто страдает от batching-атак (можно за один запрос получить данные всех пользователей, если не прописаны правильные правила доступа на поле). На наличие GraphQL можно проверить стандартным запросом POST /graphql или вариациями.

Безопасность сессий и уведомлений

Cookies и сессии: (обсуждено выше в контексте аутентификации) – это фундамент безопасности. Если сессионные cookies плохо защищены, атаки типа Session Hijacking упрощаются. По наблюдениям исследователей, у некоторых проектов встречались небезопасные cookies – например, без флага Secure или HttpOnly
linkedin.com
. В контексте Zooplus нужно убедиться, что таких пропусков нет. Также имеет смысл проверить поведение cookie при выходе из аккаунта: уничтожается ли сессия на сервере, обновляется ли идентификатор сессии при логине/логауте (для предотвращения фиксации сессии).

Email-уведомления: Zooplus активно высылает письма (подтверждения заказов, промо-рассылки, уведомления о смене пароля и т.д.). Здесь есть несколько потенциальных точек внимания:

HTML Injection в письмах: Если какие-то поля пользователя вставляются в шаблон письма без должной очистки, возможна инъекция. Например, поле «Имя» включается в приветствие письма. Если злоумышленник смог ввести в имя фрагмент HTML/JS, то теоретически при открытии письма в веб-клиенте это может исполниться (хотя современные почтовые клиенты обычно вырезают скрипты). Тем не менее, подобный баг был бы критичен (Stored XSS, затрагивающий внешних пользователей).

Манипуляции с ссылками в письме: Проверить, что ссылки подтверждения email или сброса пароля содержат достаточную энтропию и привязаны к пользователю. Если ссылка устроена как https://zooplus.de/reset?token=ABC&email=user@..., убедиться, что токен уникальный и долгий; иначе атакующий мог бы подобрать токен и сбросить пароль жертвы. Также важно, что такие ссылки одноразовые.

Отписка от рассылки и пр.: Ссылки "unsubscribe" зачастую содержат идентификатор пользователя. Нужно проверить, не позволяют ли они раскрыть что-то или отписать чужой email (обычно там email в параметре + токен; если токена нет, можно отписать любого, что считается багом).

Спуфинг и SPF/DMARC: Настройки почтовой безопасности (SPF, DKIM, DMARC) косвенно влияют на устойчивость к фишингу. Если у Zooplus не настроен DMARC, злоумышленник мог бы подделать письмо от их имени. Однако такие настройки обычно не в фокусе багбаунти, кроме случаев, когда неправильная конфигурация позволяет захватить домен для рассылки (например, у третьей стороны).

Перспективные направления атаки

На основе анализа, наиболее перспективными для первоначального исследования выглядят следующие векторы:

IDOR (неправильная авторизация): Проверка доступа к сущностям другого пользователя – адресам, заказам, профилю. История показывает, что у Zooplus уже находили как минимум две уязвимости этого класса
linkedin.com
, что намекает на возможные пропуски в контроле доступа. Это один из первых направлений тестирования, т.к. потенциально позволяет получить чужие персональные данные.

XSS (скриптовые инъекции): Как отражённые, так и хранимые. Ранее на сайте неоднократно фиксировались XSS-уязвимости
openbugbounty.org
, а один исследователь упоминает находку Stored XSS на Zooplus
linkedin.com
. Стоит тщательно проверить все точки ввода, особенно поля профиля, формы обратной связи, поиск по сайту, отзывы о товарах (если таковые есть). Автоматизированно можно использовать анализатор DOM XSS в динамических компонентах. XSS может дать полный компромет аккаунта при удачном использовании.

CSRF на ключевые действия: Если будут обнаружены места без CSRF-защиты, их эксплуатация обычно проста (достаточно заманить пользователя на специальную страницу). В e-commerce особенно опасно отсутствие CSRF на изменение контактов, пароля, оплаты. Поэтому ручная проверка форм и запросов на наличие токена необходима.

Отсутствие ограничений (Rate limiting): Попытаться автоматизировать ввод неверных паролей, перебор номеров заказов, купонов. Если не встретится блокировка или увеличение задержки, это весомый баг (позволяет, например, брутфорсить пароли или масскированно искать учетные записи по email). Также стоит проверить API, если найдётся, на тот же аспект – нет ли возможностей массированного сканирования.

Аудит конфигурации и протоколов: Это скорее вспомогательное направление. Например, проверить ответы сервера – присутствуют ли важные заголовки (X-Frame-Options, Content-Security-Policy и др.). Их отсутствие само по себе не критично, но зачастую сочетается с другими уязвимостями. Insecure cookies или широкие разрешения CORS тоже могут быть обнаружены простым осмотром ответов. Эти проблемы в сочетании с XSS/злоумышленным сайтом могут усугубить атаку
linkedin.com
.

В заключение, сайт Zooplus представляет типовой для e-commerce набор целей для багбаунти. Начать имеет смысл с авторизации и доступа к данным (IDOR), затем перейти к инъекциям (XSS) и подделке запросов (CSRF), параллельно выполняя ревизию конфигурации (cookies, заголовки, CORS). Такой план отражает как исторически найденные уязвимости, так и общие слабые места онлайн-магазинов. Соблюдая правила программы и не выходя за скоп, исследователь имеет хорошие шансы обнаружить новые проблемы в этих зонах.