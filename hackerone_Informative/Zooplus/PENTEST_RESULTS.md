# Zooplus Penetration Test Results

**Date:** 2025-12-08  
**Target:** www.zooplus.de, www.zooplus.co.uk, www.zooplus.com, zooplus.net  
**Tester:** Security Research Team  
**Status:** In Progress

---

## Executive Summary

–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Zooplus —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–º—É –ø–ª–∞–Ω—É (`PENTEST_PLAN.md`). –í—ã–ø–æ–ª–Ω–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ —Ä—É—á–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

### Key Statistics

| Metric | Count |
|--------|-------|
| Tests Performed | 8 |
| Vulnerabilities Found | 16 (Security Headers) |
| Critical | 0 |
| High | 0 |
| Medium | 6 |
| Low | 7 |
| Info | 3 |

---

## Testing Methodology

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º:

1. ‚úÖ **Security Headers** - Completed
2. ‚ö†Ô∏è **XSS Testing** - Partially completed (requires authentication)
3. üîÑ **Rate Limiting** - In progress
4. ‚è∏Ô∏è **IDOR Testing** - Pending (requires valid tokens)
5. ‚è∏Ô∏è **CSRF Testing** - Pending (requires authentication)
6. ‚è∏Ô∏è **Cart/Checkout Logic** - Pending
7. ‚è∏Ô∏è **API Security** - Pending
8. ‚è∏Ô∏è **Promo Codes** - Pending

---

## Findings

### 1. Missing Security Headers (MEDIUM)

**Affected Pages:** All pages (/, /myaccount, /checkout)

#### 1.1 Missing Content-Security-Policy

**Severity:** MEDIUM  
**CVSS:** 5.3  
**CWE:** CWE-16 (Configuration)

**Description:**  
Content-Security-Policy header –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç XSS-–∞—Ç–∞–∫ –∏ –∏–Ω—ä–µ–∫—Ü–∏–π –¥–∞–Ω–Ω—ã—Ö.

**Impact:**
- –û—Å–ª–∞–±–ª–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç XSS
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ —Å—Ç–∏–ª–µ–π

**Recommendation:**
```http
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' https://trusted-cdn.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://api.zooplus.de
```

**Evidence:**
```bash
curl -I https://www.zooplus.de
# No Content-Security-Policy header present
```

---

#### 1.2 Missing X-Frame-Options

**Severity:** MEDIUM  
**CVSS:** 4.3  
**CWE:** CWE-1021 (Clickjacking)

**Description:**  
X-Frame-Options header –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∞–π—Ç —É—è–∑–≤–∏–º—ã–º –∫ clickjacking –∞—Ç–∞–∫–∞–º.

**Impact:**
- –°—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–≥—É—Ç –±—ã—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ iframe –Ω–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Å–∞–π—Ç–∞—Ö
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è clickjacking –∞—Ç–∞–∫
- –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è checkout –∏ login —Å—Ç—Ä–∞–Ω–∏—Ü

**Recommendation:**
```http
X-Frame-Options: DENY
# –∏–ª–∏
X-Frame-Options: SAMEORIGIN
```

**Proof of Concept:**
```html
<!DOCTYPE html>
<html>
<head><title>Clickjacking PoC</title></head>
<body>
<iframe src="https://www.zooplus.de/checkout" width="800" height="600"></iframe>
<!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ iframe -->
</body>
</html>
```

---

### 2. Missing X-Content-Type-Options (LOW)

**Severity:** LOW  
**CVSS:** 3.7  
**CWE:** CWE-16

**Description:**  
X-Content-Type-Options: nosniff –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö.

**Impact:**
- –ë—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å MIME-type
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å XSS —á–µ—Ä–µ–∑ MIME-sniffing

**Recommendation:**
```http
X-Content-Type-Options: nosniff
```

---

### 3. Missing Referrer-Policy (LOW)

**Severity:** LOW  
**CVSS:** 3.1  
**CWE:** CWE-200 (Information Exposure)

**Description:**  
Referrer-Policy header –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

**Impact:**
- URLs —Å sensitive –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –º–æ–≥—É—Ç —É—Ç–µ–∫–∞—Ç—å –≤ Referer header
- –¢—Ä–µ—Ç—å–∏ —Å—Ç–æ—Ä–æ–Ω—ã –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å internal URLs

**Recommendation:**
```http
Referrer-Policy: strict-origin-when-cross-origin
```

---

### 4. Possible Mixed Content (LOW)

**Severity:** LOW  
**CVSS:** 3.7

**Description:**  
–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –≤–æ–∑–º–æ–∂–Ω—ã–µ HTTP —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ HTTPS —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö.

**Status:** Requires manual verification

**Recommendation:**
- Audit all resources (images, scripts, styles)
- Ensure all resources loaded over HTTPS
- Use CSP to block mixed content

---

## Positive Findings (Security Controls in Place)

### ‚úÖ HSTS Properly Configured

```http
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
```

**Status:** ‚úÖ GOOD  
All pages have proper HSTS with long max-age and includeSubDomains.

---

### ‚úÖ Secure Cookies

**Cookie:** `sid`  
**Flags:**
- ‚úÖ Secure
- ‚úÖ HttpOnly  
- ‚úÖ SameSite: Lax

**Status:** ‚úÖ GOOD  
Session cookies properly protected.

---

### ‚úÖ HTTPS Enforcement

**Status:** ‚úÖ GOOD  
HTTP requests properly redirect to HTTPS.

---

### ‚úÖ XSS Protection in Search

**Status:** ‚úÖ GOOD  
Search input properly escapes user data. No reflected XSS found.

**Tested Payloads:**
```html
<script>alert(1)</script>
<img src=x onerror=alert(1)>
"><img src=x onerror=alert(1)>
<svg onload=alert(1)>
</script><img src=x onerror=alert(1)>
```

All properly escaped.

---

### ‚úÖ IDOR Protection on Customer Config

**Endpoint:** `/myaccount/api/customer-config/v1/customerconfiguration/<cid>`

**Status:** ‚úÖ GOOD  
Properly returns 403 Forbidden when accessing other user's data.

**Test:**
```bash
# Account A tries to access Account B's config
GET /api/customer-config/v1/customerconfiguration/456
Authorization: Bearer <account_a_token>
‚Üí 403 Forbidden ‚úÖ
```

---

## Tests Requiring Authentication

–°–ª–µ–¥—É—é—â–∏–µ —Ç–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç –≤–∞–ª–∏–¥–Ω—ã–µ session cookies –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è:

### Pending XSS Tests

- ‚è∏Ô∏è Profile fields (firstName, lastName, companyName)
- ‚è∏Ô∏è Address fields (street, city)
- ‚è∏Ô∏è Product reviews
- ‚è∏Ô∏è Gift messages
- ‚è∏Ô∏è Order notes

### Pending IDOR Tests

- ‚è∏Ô∏è Orders and invoices
- ‚è∏Ô∏è Saved addresses
- ‚è∏Ô∏è Payment methods
- ‚è∏Ô∏è Loyalty points

### Pending CSRF Tests

- ‚è∏Ô∏è Profile update
- ‚è∏Ô∏è Password change
- ‚è∏Ô∏è Email change
- ‚è∏Ô∏è Add to cart
- ‚è∏Ô∏è Address CRUD
- ‚è∏Ô∏è Payment method add
- ‚è∏Ô∏è Order confirmation

### Pending Business Logic Tests

- ‚è∏Ô∏è Price manipulation in cart
- ‚è∏Ô∏è Quantity tampering
- ‚è∏Ô∏è Promo code enumeration
- ‚è∏Ô∏è Promo code reuse
- ‚è∏Ô∏è Negative quantities

---

## Manual Testing Notes

–ò–∑ `report.txt`:

### Already Tested Endpoints

```
‚úÖ myaccount/api/order-details/v3/customer/lastOrders ‚Üí 200, empty
‚úÖ myaccount/api/customer-config/v1/customerconfiguration/<cid> ‚Üí IDOR blocked (403)
‚úÖ checkout/api/cart-api/v1|v2/cart/<uuid> ‚Üí 200, empty cart
‚úÖ protected/api/loyalty-management/* ‚Üí 401 (properly protected)
‚úÖ GraphQL: www.zooplus.de/graphql ‚Üí 404 (not available)
```

### Blocked/Not Accessible

```
‚ùå Profile/address forms - page errors
‚ùå No real orders - cannot test invoice IDOR
‚ùå Loyalty endpoints - 401 even with token
‚ùå GraphQL - not available
```

---

## Recommendations Priority

### Immediate (MEDIUM Severity)

1. **Add Content-Security-Policy header**
   - Prevents XSS and data injection attacks
   - Implement gradually with report-only mode first

2. **Add X-Frame-Options header**
   - Prevents clickjacking on checkout/login pages
   - Quick win - single header addition

3. **Review and fix mixed content**
   - Ensure all resources over HTTPS
   - Use CSP to block http:// resources

### Short-term (LOW Severity)

4. **Add X-Content-Type-Options: nosniff**
   - Prevents MIME-sniffing attacks
   - Easy to implement

5. **Add Referrer-Policy**
   - Prevents URL leakage to third parties
   - Good privacy practice

6. **Add Permissions-Policy**
   - Control browser features
   - Defense in depth

---

## Next Steps

### For Complete Testing

1. **Obtain valid session tokens** for both test accounts
2. **Complete authenticated tests:**
   - Full XSS testing (profile, addresses, reviews)
   - Complete IDOR testing (orders, invoices, payments)
   - CSRF testing on all state-changing operations
   - Cart/checkout logic testing

3. **Create test orders** to test:
   - Invoice IDOR
   - Order manipulation
   - Reorder functionality

4. **Rate limiting comprehensive test:**
   - Login endpoint
   - Password reset
   - API endpoints
   - Promo code checks

5. **Business logic testing:**
   - Price manipulation
   - Promo code abuse
   - Negative quantities
   - Race conditions

---

## Automated Test Scripts Created

### Available Scripts

| Script | Purpose | Status |
|--------|---------|--------|
| `test_security_headers.py` | Security headers audit | ‚úÖ Completed |
| `test_xss_full.py` | Comprehensive XSS testing | ‚ö†Ô∏è Needs auth |
| `test_idor_comprehensive.py` | IDOR testing | ‚ö†Ô∏è Needs tokens |
| `test_csrf.py` | CSRF protection testing | ‚ö†Ô∏è Needs auth |
| `test_rate_limiting.py` | Rate limit testing | üîÑ In progress |
| `run_full_pentest.py` | Master test runner | ‚úÖ Ready |

---

## Tools & Environment

**Accounts Used:**
- Account A: duststorm155@doncong.com
- Account B: suobup@dunkos.xyz

**Tools:**
- Python 3.x
- requests library
- Custom automated test scripts
- Manual browser testing

**Scope:**
- www.zooplus.de ‚úÖ
- www.zooplus.co.uk ‚è∏Ô∏è
- www.zooplus.com ‚è∏Ô∏è
- zooplus.net ‚è∏Ô∏è

---

## Files Generated

```
Zooplus/
‚îú‚îÄ‚îÄ reports/
‚îÇ   ‚îú‚îÄ‚îÄ security_headers_findings.json
‚îÇ   ‚îú‚îÄ‚îÄ pentest_summary.json (pending)
‚îÇ   ‚îî‚îÄ‚îÄ ... (other test results)
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ test_security_headers.py
‚îÇ   ‚îú‚îÄ‚îÄ test_xss_full.py
‚îÇ   ‚îú‚îÄ‚îÄ test_idor_comprehensive.py
‚îÇ   ‚îú‚îÄ‚îÄ test_csrf.py
‚îÇ   ‚îú‚îÄ‚îÄ test_rate_limiting.py
‚îÇ   ‚îî‚îÄ‚îÄ run_full_pentest.py
‚îú‚îÄ‚îÄ PENTEST_PLAN.md
‚îú‚îÄ‚îÄ TEST_CHECKLIST.md
‚îú‚îÄ‚îÄ PENTEST_RESULTS.md (this file)
‚îî‚îÄ‚îÄ findings.md
```

---

## Conclusion

### Summary

- ‚úÖ Basic security controls –≤ —Ü–µ–ª–æ–º —Ä–∞–±–æ—Ç–∞—é—Ç —Ö–æ—Ä–æ—à–æ
- ‚ö†Ô∏è Security headers —Ç—Ä–µ–±—É—é—Ç —É–ª—É—á—à–µ–Ω–∏—è (6 MEDIUM findings)
- ‚úÖ IDOR protection –Ω–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö endpoints —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Session cookies –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω—ã
- ‚è∏Ô∏è –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ —Ç—Ä–µ–±—É—é—Ç –ø–æ–ª–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

### Next Actions Required

1. –ü–æ–ª—É—á–∏—Ç—å valid session tokens –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
2. –ó–∞–≤–µ—Ä—à–∏—Ç—å authenticated tests
3. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã –¥–ª—è IDOR testing
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å business logic
5. –ó–∞–≤–µ—Ä—à–∏—Ç—å rate limiting tests

---

**Report Date:** 2025-12-09  
**Last Updated:** 2025-12-09 00:07:00

