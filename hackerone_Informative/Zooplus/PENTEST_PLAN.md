# Zooplus Pentest Plan (Dec 2025)

## Goal and Scope
- Target primary commerce domains: `www.zooplus.de`, `www.zooplus.co.uk`, `www.zooplus.com`, and service domain `zooplus.net`.
- Out of scope per program: other local sites (e.g., `.at`, `.fr`, `.it`, etc.), affiliates (bitiba, zoohit), and veterinary portals unless explicitly allowed.
- Do not complete real purchases; stop before payment capture. No production DoS.

## Approach
- Create at least two test accounts to validate cross-user authorization and CSRF.
- Proxy all traffic (Burp/ZAP/mitmproxy) and save requests/responses to `Zooplus/reports/` for evidence.
- Keep all notes, PoCs, and scripts inside this `Zooplus` folder. Use only ASCII payloads unless required.

## Priority Attack Areas (ordered by impact)
1. **Auth + Sessions + Rate Limit**
   - Login/register/password-reset: test rate limiting, account enumeration differences, reset-token entropy, single-use enforcement, referrer leaks.
   - Cookies: ensure `HttpOnly`, `Secure`, `SameSite`; check session invalidation on logout.
2. **Access Control / IDOR (High)**
   - Orders, invoices/PDFs, addresses, profile data, loyalty points, saved payment methods: swap IDs and org/user identifiers with a second account.
3. **Checkout & Cart Logic**
   - Manipulate price/quantity/shipping/promo fields server-side; ensure totals are recomputed server-side; verify address/payment ownership.
4. **CSRF on Critical Actions**
   - Cart updates, address edits, email/phone changes, payment additions, checkout confirmation. Look for missing anti-CSRF tokens or weak Origin/Referer checks.
5. **XSS / HTML & CSS Injection**
   - Search, reviews, profile fields, gift messages, order notes, email templates, PDF/receipt rendering. Include CSS-injection patterns from prior Ripio case (style context).
6. **API & Mobile Endpoints**
   - Discover `api.*`, `m.*`, GraphQL; test CORS, IDOR/BOLA, introspection, verbose errors, and rate limits.
7. **Promo Codes / Campaigns**
   - Check reuse/expiry enforcement, enumeration of codes, server-side validation, CSRF on apply/remove.
8. **Email/SMS Notifications**
   - Token strength in reset/confirm links, one-time use, expiry, open-redirects in links, unsubscribe tokenization.
9. **Config / Headers**
   - HSTS, CSP, X-Frame-Options, Referrer-Policy; secure cookies across domains; HTTP→HTTPS redirects.
10. **Recon / Asset Hygiene**
    - Subdomain takeover on unused hosts; exposed buckets/build artifacts; debug endpoints.

## Lessons Applied from Previous Programs
- **Northern.tech:** Code review found signature verification bypass—prioritize server-side validation of tokens/IDs even if UI looks safe.
- **Ripio:** CSS injection via style context and JWT in URLs—test any user-controlled styling fields and avoid token-in-URL patterns.
- **Kong:** IDOR/BOLA and misconfig (open admin interfaces, CSRF, SSRF) were recurring—aggressively test authorization with dual accounts and URL-based fetchers.
- **Databricks:** Lack of rate limits and broad syscall surface were low-impact but informative—log negative tests and call out defense-in-depth gaps (headers, cookies, CORS).

## Execution Plan (quick start)
- Day 1: Recon + account setup; baseline headers/cookies; login/reset flow review.
- Day 2: Cart/checkout tampering, CSRF coverage, IDOR on orders/addresses/invoices.
- Day 3: XSS/CSS injection passes (UI + emails/PDFs), API/GraphQL discovery, rate-limit tests.
- Day 4: Promo-code logic, notification links, residual recon (subdomain takeover), draft findings.

## Deliverables
- Running notes and raw traffic: `Zooplus/reports/`.
- Test checklist and status: `Zooplus/TEST_CHECKLIST.md`.
- Final report and PoCs saved in this folder, with timestamps and reproduction steps.

