#!/bin/bash
echo "Monitoring extraction progress..."
echo "=================================="
echo ""

for i in {1..21}; do  # 21 iterations * 2 min = 42 minutes
    clear
    echo "EXTRACTION PROGRESS MONITOR"
    echo "=" * 80
    echo ""
    
    # Check if process is running
    if ps -p 21124 > /dev/null 2>&1; then
        ELAPSED=$(ps -p 21124 -o etime | tail -1 | tr -d ' ')
        CPU=$(ps -p 21124 -o time | tail -1 | tr -d ' ')
        echo "Status: RUNNING"
        echo "Elapsed: $ELAPSED"
        echo "CPU Time: $CPU"
        echo ""
        
        # Check if output file exists
        if [ -f critical_data_stolen.json ]; then
            echo "✅ OUTPUT FILE CREATED!"
            echo ""
            cat critical_data_stolen.json
            break
        else
            echo "Waiting for output... (check every 2 min)"
        fi
    else
        echo "Process finished or crashed"
        
        # Check for output
        if [ -f critical_data_stolen.json ]; then
            echo "✅ EXTRACTION COMPLETE!"
            cat critical_data_stolen.json
        elif [ -f continue_exploit_output.txt ]; then
            echo "Output file:"
            tail -50 continue_exploit_output.txt
        fi
        break
    fi
    
    echo ""
    echo "Next check in 2 minutes... (iteration $i/21)"
    sleep 120
done

echo ""
echo "=" * 80
echo "Monitoring complete"

