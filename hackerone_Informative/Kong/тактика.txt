Анализ уязвимостей баг-баунти программы Kong на HackerOne
Ранее обнаруженные уязвимости Kong

1. XSS (Cross-Site Scripting): Были случаи выявления XSS-уязвимостей в веб-ресурсах Kong. Например, один из публичных отчетов описывает уязвимость, позволяющую внедрить на страницу вредоносный скрипт, выполняющийся при ее загрузке (типичный сценарий XSS). Такие атаки могут приводить к компрометации сессий пользователей или выполнению действий от их имени
konghq.com
. Kong осознаёт риск XSS – в официальном блоге отмечено, что XSS-атаки внедряют вредоносный код в просматриваемые страницы и способны перехватывать пользовательские сессии
konghq.com
. В контексте продуктов Kong XSS мог быть обнаружен, например, в Kong Konnect (cloud.konghq.com) – веб-интерфейсе для управления API, либо в портале разработчиков (если пользователи могут публиковать контент), или даже в админ-панели Kong Enterprise. Публичные прецеденты XSS обычно классифицировались как средние или низкие уязвимости (P3/P4), с небольшими баунти (~$100–$500), однако stored XSS с влиянием на аккаунты других пользователей мог бы повысить критичность.

2. CSRF (Cross-Site Request Forgery): Пока нет публичных отчетов о CSRF в продуктах Kong, но как типовой вектор он всегда учитывается. Если у Kong Konnect или другого веб-интерфейса есть состояния, изменяющие запросы (например, изменение настроек, токенов), отсутствие защиты (например, CSRF-токенов) могло бы позволить злоумышленнику заставить администратора выполнить нежелательное действие. В хорошо защищенных приложениях API, таких как Kong, CSRF обычно предотвращается за счет строгой проверки источника или использования токенов, но при анализе стоит проверить панель управления Kong Konnect и портал на уязвимость к CSRF (особенно функции, выполняющие критичные действия, как создание сервисов, ключей и пр.).

3. RCE (Remote Code Execution): Критически опасный вид уязвимостей. Пример – уязвимость в Kong Insomnia (десктоп-клиент для API), обнаруженная исследователями в 2025 году. Они нашли template injection уязвимость: простая импортирование вредоносного файла коллекции или получение специально сформированного API-ответа могло привести к выполнению произвольного кода на компьютере, где запущен Insomnia
tantosec.com
. Эта уязвимость позволяла атакующему удаленно выполнить код благодаря механизму шаблонов Insomnia (Nunjucks) – фактически RCE на машине пользователя, и была оценена как критическая (CVSS ~9.3). Kong работал над исправлением, однако изначальные патчи можно было обходить, и проблема потребовала нескольких итераций фиксов
tantosec.com
. Помимо Insomnia, RCE-уязвимости потенциально могут возникать и в серверных продуктах. Например, в Kong Gateway RCE могло бы проявиться при эксплуатации плагинов (выполняющих Lua-код) или чрезмерных привилегий Admin API. Прямых кейсов RCE в самом Gateway пока не раскрыто публично, но связанная проблема – небезопасная настройка Admin API. CVE-2020-11710 отмечал, что в некоторых конфигурациях Admin API мог быть доступен извне (не только на 127.0.0.1), что позволяло удаленно менять конфигурацию и потенциально выполнять код (через загрузку плагинов и пр.). Kong назвал это не уязвимостью продукта, а ошибочной конфигурацией в примере Docker Compose
app.opencve.io
. Тем не менее, сам факт открытого Admin API – серьезная проблема: без аутентификации злоумышленник получает полный контроль над шлюзом. В базе знаний уязвимостей отдельно подчёркнуто, что Admin API Kong должен быть ограничен локальным доступом – были обнаружены инстансы, где API открыт без защиты, что требует срочного ограничения доступа
invicti.com
.

4. SSRF (Server-Side Request Forgery): Для Kong SSRF-атаки теоретически возможны в компонентах, которые делают исходящие запросы по URL, заданным пользователем. Например, если Kong Manager или Kong Konnect позволяют указывать внешние URL для интеграций (webhook-и, подключение сервисов) или если какой-то плагин (например, Proxy Cache, AWS Lambda, HTTP Log) принимает удаленный адрес, злоумышленник мог бы попытаться подсунуть внутренний адрес. Публичных отчетов о SSRF в Kong пока не видно, но аналогии можно провести: у конкурирующих решений API Gateway SSRF находили через функциональность, связанную с интеграциями. Следует проверить места, где Kong может выполнять HTTP-запросы по заданному адресу (например, загрузка схем, интеграции с OAuth/OpenID – например, openid-connect plugin загружает JWKS по URL). SSRF может привести к сканированию внутренних сетей Kong (в случае SaaS Konnect) либо к утечке данных с внутренних API. В одном публичном багбаунти-отчете (не Kong) исследователь комбинировал XSS и SSRF для расширения атаки, что показывает актуальность этих векторов
hackerone.com
. Для Kong целесообразно тестировать SSRF на cloud.konghq.com API (например, заменить URL-ы в настройках на http://127.0.0.1 или внутренние хосты) и на Kong Gateway Admin API (который теоретически мог бы делать DNS-разрешения при некоторой конфигурации).

5. SQLi (SQL Injection): Прямые SQL-инъекции в продуктах Kong менее вероятны, так как Kong Gateway использует базу (PostgreSQL/Cassandra) с ORM/моделями, а внешние входные данные обычно не образуют прямых запросов. Тем не менее, Kong Manager (Enterprise) – веб-интерфейс администрирования – мог содержать SQLi, если где-то запросы формировались некорректно. Публичных случаев SQLi в Kong не зарегистрировано. Но как класс атаки SQL-инъекция всегда рассматривается: она позволяет извлекать или модифицировать данные в БД, отправляя специальный ввод. Kong даже выпустил специальный плагин Injection Protection, который фильтрует запросы с признаками SQLi или XSS
konghq.com
, что указывает на наличие подобного риска. При тестировании стоит применять типовые SQLi-пейлоады (' OR '1'='1, UNION SELECT ... и т.д.) в местах, где Gateway или связанные сервисы могли бы обрабатывать параметры как часть запросов (например, фильтры, поиск в API Developer Portal).

6. Проблемы с авторизацией API и токенами: Это одна из самых важных областей. В истории Kong есть пример обхода аутентификации: уязвимость в JWT-плагине (CVE-2021-27306) позволяла получить доступ к защищенным маршрутам без валидного JWT-токена
app.opencve.io
. Проще говоря, из-за некорректной проверки можно было войти на эндпоинт, требующий JWT-аутентификации, вообще без токена – критичный сбой логики контроля доступа. Подобные BOLA/IDOR-уязвимости (несоответствие между проверкой прав и доступом к объектам) очень актуальны для Kong Konnect – многоарендного облачного сервиса. Например, можно попытаться вызвать API-запрос с идентификатором чужого ресурса (службы, маршрута, аккаунта) и проверить, не выдаются ли данные или не выполняется ли действие. Уже были примеры отчетов на HackerOne, когда исследователи находили ошибки бизнес-логики в Kong: один из публично раскрытых отчетов (Medium severity) касался именно логической ошибки, связанной с проверкой прав
hackerone.com
. В описании он классифицирован как Business Logic Errors, что может подразумевать недостатки авторизации (например, возможность обычному пользователю совершить действие администратора при определенных условиях). Также стоит проверить системы токенов: как управляются API-keys, есть ли возможность их предсказать или пропустить проверку, насколько безопасно реализован OAuth2 (если используется). Примеры потенциальных проблем: утечка ключей через рефереры или логи, отсутствие проверки подписи JWT в каких-то сценариях, reuse токенов после логаута, отсутствие ограничения по.scope у OAuth-токенов и т.д.

7. Неправильные конфигурации (Misconfigurations): Как упоминалось, открытый Admin API без ограничения – яркий пример опасной конфигурации. Kong прямо рекомендует держать Admin API только на localhost и применять аутентификацию и firewall для доступа
invicti.com
. В баг-баунти программе Kong явно включена проверка на уязвимости типа subdomain takeover – захват поддомена инфраструктуры Kong. Уже вознаграждались находки, когда исследователи обнаруживали неиспользуемые поддомены *.konghq.com, направленные на удаленные сервисы (например, на GitHub Pages, AWS S3 и др.), которые можно взять под контроль. Такие атаки не затрагивают основной код, но компрометируют подсайт (например, документацию или маркетинговый субдомен). Kong включает это в scope и относит к средним рискам (P3)
bbradar.io
. Другие misconfiguration-проблемы: публично доступные отладочные интерфейсы, забытые .git-репозитории на серверах, страницы статуса системы, отключенные настройки безопасности (CSP, HSTS) и т.п. – в программе они, как правило, считаются низкоопасными, но все равно приемлемы к сообщению.

8. Повышение привилегий и обход аутентификации: В экосистеме Kong потенциальные точки эскалации – это Kong Konnect и Identity. Например, система us.identity.konghq.com (видимо, Single Sign-On сервис) – если в ней обнаружится уязвимость (скажем, лёгкий перебор учетных записей или обход двухфакторной аутентификации), атакующий может получить доступ к аккаунту администратора Konnect. Следует проверить механизмы восстановления пароля, приглашения пользователей в организацию Kong Konnect – нет ли там возможности перехватить контроль (как, например, класически: IDOR при сбросе пароля или уязвимость типа Confused Deputy при OAuth-связывании аккаунтов). В открытых источниках были статьи, описывающие баги с reset password IDOR (не конкретно в Kong, но общий пример, когда зная чужой ID можно сбросить ему пароль)
kongsec.medium.com
kongsec.medium.com
. Для Kong такие сценарии особенно важны, учитывая наличие облачного портала.

Типовые векторы атак для продуктов Kong

На базе приведенного анализа можно перечислить наиболее вероятные векторы атак для продуктов Kong (Gateway, Konnect, Insomnia, Mesh и др.):

XSS (межсайтовый скриптинг): Актуален для веб-компонентов Kong – Konnect UI, Dev Portal, Kong Manager. Проверять поля ввода, которые могут отобразиться без правильной фильтрации (имена сервисов, описания, сообщения об ошибках). Использовать разные XSS-пейлоады (простые <script>alert(1)</script> и продвинутые onerror-хаки, JavaScript-схемы и т.п.) и учитывать CSP, если внедрена.

CSRF: Вызовы к защищенным действиям Konnect/UI через сторонний сайт. Если приложение не требует токена/Origin, CSRF возможен. Проверять основные POST/DELETE действия (создание пользователей, токенов, изменение настроек). Пейлоады: скрытые формы или fetch-запросы к целевым API с автоматически подтягиваемыми куками пользователя.

RCE: В Insomnia – пытаться эксплуатировать шаблоны (например, ввод {{= concat(...) }} или похожих выражений Nunjucks) в различных полях (URL, cookies, environment) как описано в кейсе
tantosec.com
. В Kong Gateway – искать возможности загрузки исполняемого кода: например, через Lua-snippet плагин (если такой функционал открыт в Enterprise) или через уязвимости плагинов. В Kong Mesh – проверять конфиг-файлы/полисы на исполнение команд (Mesh основан на Envoy, менее вероятно, но можно смотреть CVE по Envoy). Типичный подход – фаззинг входных точек, чтобы выявить признаки выполнения кода (например, отправить шаблон ${{7*7}} и видеть 49 в ответе – явный SSTI). Использовать для fuzzing инструмент типа Burp Intruder или ffuf со словарем инъекций.

SSRF: Искать где можно указать URL или IP, который система запросит. В Konnect это может быть интеграция с upstream API (добавление сервисов по URL), webhooks, или, например, импорт OpenAPI по ссылке. В Gateway – некоторые плагины (HTTP Log, TCP Log, Serverless при определенных настройках) могут выполнять внешние обращения. Тестировать SSRF через Burp Collaborator: ввести адрес вида http://burpcollaborator/ в поле и следить, пришел ли обратный запрос. Также проверять DNS-названия (internal.konghq.com?) на случай DNS Rebinding. Payload’ы: стандартные http://127.0.0.1:80 (чтобы попытаться достучаться до локальных сервисов), либо file:///etc/passwd если есть поддержка разных схем (признак потенциального LFI).

SQLi: Несмотря на отсутствие явных примеров, включать тестирование основных параметров (фильтры, поиск, ID) на SQL-инъекцию. Инструменты: sqlmap для автоматизации на обнаруженных параметрах REST (например, ?filter=), но чаще ручные простые тесты через ' и -- для выявления ошибок SQL. Особое внимание – Kong Manager (Enterprise GUI), если доступен для теста, потому что он взаимодействует с БД Kong.

Broken Authentication / OAuth bugs: Проверять процессы логина и регистрации: нет ли перебора учетных записей (отрезают ли ответ, различим ли ответ при правильном/неправильном email), открытого редиректа после логина (может привести к фишингу), уязвимости типа крайне простой пароль по умолчанию. Если Kong Konnect позволяет вход через SSO, убедиться, что нет возможности обойти SSO (например, прямой запрос к API с незаполненным токеном). При работе с JWT/OAuth токенами – проверять подписи (например, классическая атака с подменой алгоритма на none или подбором ключа, хотя в Kong JWT plugin такие вещи учтены). Для REST API Konnect – использовать инструмент Authz (Burp extension Autorize) для тестирования IDOR/BOLA: создать два аккаунта (например, админ и обычный) и с одного пробовать доступ к ресурсам другого, выявляя дырявые эндпоинты.

Privilege Escalation & IDOR: Как отмечалось, исследовать все ID, UUID в запросах Kong Konnect. Например, endpoints вида /api/{orgId}/services/... – попробовать сменить orgId или другие идентификаторы на чужие. Проверить функционал приглашения в организацию – нет ли возможности самому себе повысить роль (например, пригласить существующий email с ролью admin – иногда платформа ошибочно объединяет аккаунты). Также функции управления пользователями: изменение чужого пароля, редактирование профиля с повышением роли. Payload: подмена идентификаторов, либо пересечение методов (e.g., если GUI запрещает, попробовать через API напрямую). Использовать Burp Repeater для ручной тонкой настройки таких запросов и сравнения ответов.

Subdomain Takeover: Выполнить рекон (например, Assetnote, Subfinder для доменов konghq.com). Цель – найти CNAME-записи на удаленные хостинги (AWS S3, GitHub Pages, Readme.io и пр.) которые не настроены. Если обнаружен такой поддомен, проверить возможность создания ресурса с тем именем. Инструменты: subjack, subzy – автоматические сканеры takeover. При нахождении – убедиться, что реально удается разместить свой контент по адресу. В отчете достаточно показать доказательство контроля (например, уникальная строка на открытом захваченном поддомене). Kong рассматривает takeover как валидный уязвимый сценарий (в scope)
bbradar.io
, хотя и без доступа к внутренней сети – обычно средний приоритет.

API rate-limit и DoS: Хотя не упомянуто явно в вопросе, для полноты можно учитывать: Kong Gateway – высокопроизводительный, но возможно атака типа HTTP/2 DoS (как CVE-2023-44487, повлиявший на многие системы). Проверять устойчивость к большим объемам запросов, отсутствию rate limiting на критичных API (например, бесконечные попытки логина без капчи). Такие проблемы, если найдены, обычно оцениваются как Low/Medium, но в сочетании с другим багом могут повысить риск.

Тактика поиска критических/высоких уязвимостей

Ниже представлена рекомендуемая тактика пентеста, ориентированная на выявление High или Critical багов в рамках программы Kong:

1. Приоритезация целей (Scope фокус)

Kong Konnect (cloud.konghq.com) – облачная платформа управления API. Наивысший приоритет: любые уязвимости, позволяющие получить доступ к чужим данным или учетным записям, будут критичными. Например, BOLA/IDOR в органищациях Konnect, утечка конфиденциальных ключей, обход аутентификации в консоли. Также в Konnect есть интеграция с Gateway – возможно, через нее можно достичь неожиданных действий. Эта часть находится под bounty, поэтому сконцентрироваться на ней имеет смысл в первую очередь.

Kong Gateway Enterprise (сам продукт) и поддерживаемые плагины: поиск новых уязвимостей уровня продукта (RCE, логические баги) – сложнее, но и вознаграждается. Если удастся найти баг в собственном коде Gateway или официальных плагинов (например, Auth, Proxy, ACL, Dev Portal), это будет значимый результат. Особое внимание – JWT, OAuth2, ACL плагины (в прошлом уже были ошибки, CVE-2021-27306 в JWT
app.opencve.io
). Имейте в виду: Kong Gateway OSS в scope без баунти, но Enterprise-версии/официальные плагины – с баунти. Поэтому, например, баг в open-source коде, влияющий на Enterprise пользователей, скорее всего все равно вознаградят (Kong является CNA и присваивает CVE найденным багам
hackerone.com
).

Insomnia (Desktop & CLI): уязвимости в Insomnia могут быть критическими (RCE), однако их поиск требует другого подхода – анализ десктоп-приложения. Если вы владеете реверс-инжинирингом или можете проанализировать исходники (Insomnia – open source), попробуйте найти уязвимости, связанные с обработкой данных: инъекции шаблонов (как уже был случай), небезопасная десериализация, выполнение плагинов. Учтите, что эксплуатировать баги Insomnia обычно сложнее (нужно заставить пользователя импортировать файл или перейти по вредоносному URL в Insomnia), поэтому для критичности нужна высокая вероятность эксплуатации. Тем не менее, Insomnia – привлекательная цель, так как прошлый RCE-пример показал недостатки. К тому же, программа Kong теперь явно покрывает Insomnia, так что баги там принимаются.

*Инфраструктура Kong (домен konghq.com, GitHub Actions): поддомены, DNS, CI/CD. Здесь скорее средние находки (takeovers, инфо утечки), но изредка можно найти что-то высокое. Например, неправильная настройка GitHub Actions (в scope) – если там утечет секрет или можно выполнить код через Pull Request – может дать доступ к приватным репозиториям или пакетам (это уже высокий риск). Поэтому не игнорируйте scope типа “GitHub Actions в публичных репо Kong” – проведите аудит workflows на наличие pull_request: open с небезопасными шагами.

Kong Mesh, Ingress Controller, Kubernetes Operator: эти части тоже объявлены в scope. Они предназначены для Kubernetes/service mesh, что подразумевает сложную среду. Высокий баг здесь – это, например, обход политики безопасности в Kong Mesh (нарушение изоляции сервисов) или RCE в контроллере (через специальный манифест). Если у вас есть опыт с K8s, можно попытаться развернуть Kong Ingress Controller и проверить, не позволит ли специально сформированный Kubernetes объект выполнить код на стороне контроллера (учитывая, что он обрабатывает аннотации/специфичные ресурсы). Это достаточно нишевое направление, но именно поэтому ценные уязвимости могут быть там, где меньше всего ищут.

2. Инструменты и подходы

Сбор информации (Recon): начните с максимального картографирования внешних активов Kong. Используйте инструменты: assetfinder, SubFinder, Amass для перечисления поддоменов *.konghq.com. Затем httpx или httprobe для проверки ответов, whatweb для идентификации технологий. Цель – выявить все потенциальные цели: панели логина, API эндпоинты, документации (часто они могут содержать скрытые ссылки или ключи).

Анализ открытого кода: существенная часть продуктов Kong открыта (Gateway, Insomnia, плагины на GitHub). Загрузите репозитории и проведите статический анализ. Ищите потенциально опасные участки: функции, обрабатывающие входные данные. Например, в JavaScript-коде Konnect – поиск по ключевым словам (innerHTML, eval, token=). В Lua-коде Gateway – поиск os.execute, прямых SQL-запросов. Этот code review может подсветить слабые места, которые потом проверите практически.

Перехват и тестирование API: запустите Burp Suite (или аналог Mitmproxy/ZAP) и проксируйте весь трафик веб-интерфейса Kong Konnect. Таким образом вы получите список API-запросов. Сохраните их и затем воспроизводите через Burp Repeater, модифицируя параметры (для поиска IDOR, проверяя авторизацию). Полезно написать скрипты (Python + requests или использовать Postman/Insomnia) для автоматизации массового перебора ID или fuzzing полей. Также Burp Suite с плагинами: Autorize (для проверки авторизационных проблем) – в сочетании с двумя учетками, JSON Web Tokens (для теста атак на JWT), Collaborator client (для SSRF и out-of-band).

Fuzzing и wordlist-атаки: применяйте ffuf или Burp Intruder на обнаруженные эндпоинты. Например, если есть параметр ?page=, попробовать вставлять "><script> и другие XSS-пейлоады из словаря (например, xss payloads list). Для скрытых эндпоинтов – использовать словари (например, Kong endpoints: /services, /routes, /consumers, /plugins – стандартные Admin API пути) против домена cloud.konghq.com или api.konghq.com – вдруг что-то из этого открыто. Ещё подход: fuzz пути вроде /api/v1/ + словарь общих слов (health, status, admin, etc.) для нахождения неочевидных API.

Специфические сканеры: Проверить веб-сайты (konghq.com, docs, порталы) инструментами на известные баги. Например, Nuclei с шаблонами (есть шаблоны для common vulnerabilities, можно быстро выявить банальные вещи вроде Exposed .env или известные CVE версий). Но основное внимание – ручное исследование, т.к. наиболее ценные баги будут логическими.

Тестирование Insomnia: Здесь нужен подход на стороне клиента. Можно создать специально сформированный API, который отдаёт необычные ответы Insomnia. Например, вернёт заголовок Set-Cookie со значением {{ _.prototype.polluted = true }} (проверка на шаблонную инъекцию), или JSON, содержащий {{someCode}}. Цель – посмотреть, как Insomnia отреагирует. Также попытаться создать плагин для Insomnia (они пишутся на JavaScript) с вредоносным содержимым, и увидеть, проверяется ли их подпись. Инструменты: браузер DevTools для Insomnia (Electron-приложение), или frida для динамического анализа, если умеете. Но даже без этого – взять известный эксплойт (из упомянутого отчета Tanto Security) и проверить на последней версии Insomnia, патчили ли уязвимость полностью.

Мониторинг Hacktivity и соцсетей: Тактика – быть в курсе, какие баги находят другие. Иногда исследователи делятся в Twitter/блогах намёками. Например, упоминание уязвимости Insomnia появился на Medium вскоре после disclosure. Настройте отслеживание ключевых слов (“Kong RCE”, “Kong bug bounty”) – это поможет в реальном времени узнавать о новых классах атак на продукты Kong и сразу пробовать их на своей стороне.

3. Полезные payload’ы и тесты

Вот список тестовых нагрузок и техник для наиболее распространенных уязвимостей, применимых к Kong:

XSS-пейлоады: "<script>alert(1)</script> – базовый, для начальной проверки рефлектed XSS. Затем усложнять: "><img src=x onerror=alert(1)>, '"><svg/onload=alert(1)> для обхода фильтров. Для Angular/React контекстов – {{7*7}} или {{constructor.constructor('alert(1)')()}} (проверка на шаблонные инъекции в фронтенде). Обязательно тестируйте и stored XSS: если можно создать объект (например, название сервиса) – ввести туда скрипт, затем зайти в интерфейс, посмотреть, исполнилось ли.

CSRF-тесты: Подготовьте HTML-страничку с формой, например: <form action="https://cloud.konghq.com/api/organization/delete" method="POST"> <input name="org_id" value="XYZ"> ...</form> и откройте ее с включенной сессией Kong – проверить, выполнится ли запрос. Используйте Burp Proxy with CSRF PoC generator. Тестируйте не только GET->POST, но и Clickjacking: оберните интерфейс Kong в <iframe> (X-Frame-Options может запретить, но проверить).

IDOR/Авторизация: Сделайте два аккаунта в Konnect (если возможно: один как Owner организации, второй как Developer). Через прокси соберите запросы от обоих. Затем возьмите запросы от admin (например, GET /orgs/ORG_ID/users) и выполните их с токеном обычного пользователя – убедитесь, что получаете отказ. И наоборот: возьмите запрос от обычного и подставьте токен админа – не выдаются ли лишние данные? Автоматизируйте с Autorize: он сам переигрывает каждый запрос со вторым токеном и маркирует отличия.

SQLi-инъекции: Классические пейлоады: 1' OR '1'='1 – увидеть, нет ли в ответе аномалий или ошибок. '; SELECT pg_sleep(5)-- для time-based инъекции (если ответ задержится на 5 сек, значит, исполнилось). Обращайте внимание на ошибки в ответах API – если где-то возвращается сообщение о синтаксисе SQL, сразу эксплуатировать дальше.

Командные инъекции: В тех местах, где можно передать системные команды (маловероятно напрямую, но вдруг – например, поле для Ping/Traceroute, если такое было бы). Пробовать ; id; или && uname -a. Часто такие поля есть в UI для диагностических функций. Если найдете, используйте и out-of-band (например, ; curl <collaborator> чтобы получить DNS-выход).

SSRF-проверки: Используйте Burp Collaborator или свою открытую сервис (можно pingb.in или canarytokens). В поля URL вставляйте: http://<subdomain>.burpcollaborator.net/path. Если что-то в приложении делает запрос, вы увидите hit. Также пробуйте вариации: 127.0.0.1, localhost (для внутренних сервисов – возможно, admin API или база), 169.254.169.254 (метадата AWS – если Kong SaaS на AWS, SSRF сюда критична). Проверьте реакцию – некоторые приложения пытаются предотвратить SSRF (например, запрещают частные IP). Обходы: закодировать IP (например, http://2130706433 вместо 127.0.0.1), использовать DNS (например, http://internal.konghq.com.<collab>.net).

Файловые инъекции (LFI/RFI): Если есть параметры файлов или шаблонов. К примеру, Developer Portal Kong (в Enterprise) позволяет загружать темы – проверить, нет ли пути для RFI. Payload: ../../../../etc/passwd в имени файла или пути. Также тестировать XML External Entity (XXE) в случае, если где-то загружаются XML (например, импорт конфигурации). XXE payload: добавить <!DOCTYPE foo [ <!ELEMENT foo ANY ><!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><foo>&xxe;</foo> – и смотреть, не вернулось ли содержимое или не пошел ли запрос на внешний DTD.

Bruteforce/default creds: Для интерфейсов Kong (например, us.identity.konghq.com) – попробовать типичные пары логин/пароль (admin/admin, kong/kong или те, что указаны в доках по умолчанию для Dev Portal). Также проверить API ключи по умолчанию: если разворачивается Developer Portal, нет ли стандартного ключа. Это маловероятно для облака, но локально многие забывают менять.

GitHub Actions CI: Просмотрите YAML-файлы в репозиториях Kong (список репо есть на GitHub konghq). Ищите в .github/workflows использование небезопасных действий: например, checkout кода с стороннего репо без @v1 (pin), или pull_request триггеры, где выполняется что-то с кодом из форков. Если найдете, попытайтесь создать форк, внести вредоносный код и открыть PR – посмотреть, выполнится ли ваш код (например, может появиться в логах CI), что позволит получить токены CI. Это сложный вектор, но за такой RCE в инфраструктуре будет high/critical.

Комбинирование уязвимостей: Не останавливайтесь на одиночных багах. Попробуйте представить, как chain сделать. Например, менее значимая инфо-утечка (скажем, утечка конфигурации с секретным ключом) + непроверенный JWT может вместе дать захват аккаунта. Или XSS в сочетании с отсутствием CSP может украсть сессионный токен администратора Konnect и привести к ATO (Account Takeover). В отчете обязательно указывайте цепочки, это повышает Impact и Priority.

При проведении тестирования, внимательно следите за политикой программы. Kong может обесценивать некоторые теоретические баги – например, как было с открытым Admin API: если это известный момент и задокументировано как ответственность пользователя (self-hosted случая), то баг может быть вне выплаты. Поэтому каждый найденный баг оценивайте с точки зрения “эксплуатируемости и влияния”. Предоставляйте четкие доказательства (видео, логи, скриншоты). И обязательно ссылайтесь на свои шаги на документы или CVE (как мы делали выше) – это показывает, что вы провели глубокое исследование.

Заключение: Продукты Kong охватывают широкий спектр (от клиентского ПО до облачных сервисов и прокси-сервера), поэтому нужно сочетать методы веб-тестирования, аудита кода и даже реверс-инжиниринга. Фокусируйтесь на уязвимостях, дающих прямой несанкционированный доступ к данным или системе (Account Takeover, Remote Code Execution, обходы авторизации) – именно они с наибольшей вероятностью будут оценены как High/Critical. Ссылки на уже обнаруженные проблемы (например, уязвимость JWT-плагина
app.opencve.io
 или RCE в Insomnia
tantosec.com
) подсказывают, что такие баги реальны, а значит – при должном старании можно найти и новые. Удачной охоты!

Источники и похожие кейсы:

Отчет о RCE через шаблоны в Kong Insomnia
tantosec.com
tantosec.com

CVE-2021-27306 – bypass JWT-аутентификации в Kong Gateway
app.opencve.io

Рекомендации Kong по защите Admin API (ограничение до localhost)
invicti.com

Описание XSS и SQLi атак в контексте API (Kong blog)
konghq.com

Баунти-программа Kong – в scope входят subdomain takeover
bbradar.io
 (случаи с наградой ~$100 за захват неиспользуемых поддоменов).