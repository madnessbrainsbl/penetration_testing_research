<!DOCTYPE html>
<html>
  <head>
    <title>Ripio Widget - Token Theft PoC</title>
  </head>
  <body>
    <h1>Click the link below after widget loads</h1>

    <!-- Widget iframe with JWT in URL -->
    <iframe
      id="widget"
      width="400"
      height="600"
      src="https://d2pneqdaei3b3x.cloudfront.net/index.html?_to=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzY0NjUzODQ4LCJpYXQiOjE3NjQ2NTMyNDgsImp0aSI6IjYyNTk3NmYwZTdhNDQzMGE5YzY4NTMwOGNmYWFiNzA0IiwidXNlcl91c2VyX3V1aWQiOiI2OTFlMjEzNi00OGJiLTRlNTUtOTMxOC1hNTk0YWM5YzNjZWMiLCJwcml2YXRlIjoiZ0FBQUFBQnBMbmpBNGFoZkttcGpDUVpQWGZyRE45N20zV1h0cGhUclkzOHNnS1dkaXRCa1F2REg1aUl2MDdYTTBZbk9tX3p2ckFBTFZSWnJLX3pCeDdWOHlNeGNWOGFneHBUVndfTUduOXVDUV9OM0UybjJ6SWEzWnhTZmpXMFR4aUZsbVFDTzJOWVMxVnBUZUdxSllZTDJNd2ZHYkwyNkEtT2tPTzc0eVN0SGR2V29aUUthS1pBdXA3TkZyT25mWTZhUlppeDMtbG4wX3cyVWJKMUFQYjZjSUFNZVVCWjFnVXVvbTEtcHNKa0hYVnE4RlBYdVFEU2cxQ2pxNkRqWjByYzVZeHctdUsxSzhvVVozc0lOOThIaGt6VmphYXJ4WTExMnR6ZGdvZE9NUEdvVGhKVjYtejZrZGlmUzB5cTNnd3MyNmxqOXN3WF8iLCJ1YV9oYXNoIjoiZ0FBQUFBQnBMbmpBQXdJQ0pSTHFkcGZUejJ4NkttYk5SQmllbmZiMmM4cGxwSUJ1eHVpRktXbXlfQmRPc1liTU5FSy1iblZRalVkc1htT2h0Zl8xa2RmVlBGdVdTbGpsOWJ3RjdwWUZkR1FLQWkwNmZLRTA4azJYSThrQ0xnazhEOXlFMm5KM3k0M0dTOE9wT09DWDd0a3BVNWV2MVpFOHRlOENRNnNmSjJXaVRSakU0aUlQcEtFPSIsImJhY2siOiJSSVBJTyIsImZpbmdlcnByaW50IjoiZGJjNDgyZTVhYjYxM2Y3NDE5NzllMTFjNDBlNWQyNjY1YjNkMGQxYzQyYWQzMmU5ZWIyMGZmN2FlZDM1NGY3NCIsImhhc18yZmEiOmZhbHNlLCJpc19zdGFmZiI6ZmFsc2V9.jbx_rPhSpXm2hvjw_w7ixKfjpqjrM_t4boEAuky84rixg5TQrqsYY6eVAvAoVOsUPG7op4IFaZFmXxYLlY6arqMwcq1EPpiRLq8R-6COulJ-boYc4sJh5maCOPsWJzv2_5Nbexxd5DrG5KmygOYZT499o5tkqFabzNBoOQi18v6NmXa22Iyc5n_FCW8eu09JVPK_fooQw1QSDEeia_pG36iyZOoPiPdlvQ_uQjKdQdbklVkUP4gUpFtOvxFrOErxuOoGDgThZG5PAEhgXUJodTjVSmVsRSiK-VAAKDvfCMd9uGChJXDhJRVEkQOveH3xIsrJD1vMo4x1S55To94guw&_la=es&_cu=ars"
    >
    </iframe>

    <h2>Proof: JWT is in URL</h2>
    <p>Check the iframe src - the full JWT token is visible in the URL!</p>
    <p>This token is logged in:</p>
    <ul>
      <li>Browser history</li>
      <li>Server access logs</li>
      <li>Any proxy/CDN logs</li>
      <li>Referer header when navigating away</li>
    </ul>

    <script>
      // Extract and display the token from iframe src
      const iframe = document.getElementById("widget");
      const url = new URL(iframe.src);
      const token = url.searchParams.get("_to");
      console.log("LEAKED JWT TOKEN:", token);

      // Show in page
      const pre = document.createElement("pre");
      pre.textContent = "Token from URL: " + token.substring(0, 100) + "...";
      document.body.appendChild(pre);
    </script>
  </body>
</html>
